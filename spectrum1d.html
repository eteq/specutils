
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Working with Spectrum1Ds &#8212; specutils v0.4.dev1227</title>
    <link rel="stylesheet" href="_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="shortcut icon" href="_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Spectrum1D" href="api/specutils.spectra.spectrum1d.Spectrum1D.html" />
    <link rel="prev" title="Overview of How Specutils Represents Spectra" href="types_of_spectra.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="_static/copybutton.js"></script>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="index.html"><span id="logotext1">spec</span><span id="logotext2">utils</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="genindex.html">Index</a></li>
    <li><a title="Module Index" href="py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="api/specutils.spectra.spectrum1d.Spectrum1D.html" title="Spectrum1D">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="types_of_spectra.html" title="Overview of How Specutils Represents Spectra">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="index.html">specutils v0.4.dev1227</a>
	 &#187;
      </li>
      
      <li>Working with Spectrum1Ds</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="working-with-spectrum1ds">
<h1>Working with Spectrum1Ds<a class="headerlink" href="#working-with-spectrum1ds" title="Permalink to this headline">¶</a></h1>
<p>As described in more detail in <a class="reference internal" href="types_of_spectra.html"><span class="doc">Overview of How Specutils Represents Spectra</span></a>, the core data class in
specutils for a single spectrum is <code class="xref py py-obj docutils literal notranslate"><span class="pre">Spectrum1D</span></code>.  This object
can represent either one or many spectra, all with the same <code class="docutils literal notranslate"><span class="pre">spectral_axis</span></code>.
This section describes some of the basic features of this class.</p>
<div class="section" id="basic-spectrum-creation">
<h2>Basic Spectrum Creation<a class="headerlink" href="#basic-spectrum-creation" title="Permalink to this headline">¶</a></h2>
<p>The simplest (and most powerful) way to create a <code class="xref py py-obj docutils literal notranslate"><span class="pre">Spectrum1D</span></code> is to
create it explicitly from arrays or <a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="(in Astropy v3.0.4)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Quantity</span></code></a> objects:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">specutils</span> <span class="k">import</span> <span class="n">Spectrum1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">Jy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5100</span><span class="p">,</span> <span class="mi">5300</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec1d</span> <span class="o">=</span> <span class="n">Spectrum1D</span><span class="p">(</span><span class="n">spectral_axis</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">spec1d</span><span class="o">.</span><span class="n">flux</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Dispersion&quot;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Flux&quot;</span><span class="p">)</span>  
</pre></div>
</div>
<p>(<a class="reference external" href=".//spectrum1d-1.py">Source code</a>, <a class="reference external" href=".//spectrum1d-1.png">png</a>, <a class="reference external" href=".//spectrum1d-1.hires.png">hires.png</a>, <a class="reference external" href=".//spectrum1d-1.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="_images/spectrum1d-1.png" src="_images/spectrum1d-1.png" />
</div>
</div>
<div class="section" id="reading-from-a-file">
<h2>Reading from a File<a class="headerlink" href="#reading-from-a-file" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">specutils</span></code> takes advantage of the Astropy IO machinery and allows loading and
writing to files. The example below shows loading a FITS file. While specutils
has some basic data loaders, for more complicated or custom files, users are
encouraged to <a class="reference internal" href="custom_loading.html"><span class="doc">create their own loader</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">specutils</span> <span class="kn">import</span> <span class="n">Spectrum1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec1d</span> <span class="o">=</span> <span class="n">Spectrum1D</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;/path/to/file.fits&quot;</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="section" id="including-uncertainties">
<h2>Including Uncertainties<a class="headerlink" href="#including-uncertainties" title="Permalink to this headline">¶</a></h2>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum1D</span></code> class supports uncertainties, and
arithmetic operations performed with <code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum1D</span></code>
objects will propagate uncertainties.</p>
<p>Uncertainties are a special subclass of <a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.nddata.NDData.html#astropy.nddata.NDData" title="(in Astropy v3.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDData</span></code></a>, and their
propagation rules are implemented at the class level. Therefore, users must
specify the uncertainty type at creation time</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">specutils</span> <span class="kn">import</span> <span class="n">Spectrum1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.nddata</span> <span class="kn">import</span> <span class="n">StdDevUncertainty</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">Spectrum1D</span><span class="p">(</span><span class="n">spectral_axis</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">5010</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="n">flux</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">Jy</span><span class="p">,</span> <span class="n">uncertainty</span><span class="o">=</span><span class="n">StdDevUncertainty</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Not defining an uncertainty class will result in an
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.nddata.UnknownUncertainty.html#astropy.nddata.UnknownUncertainty" title="(in Astropy v3.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnknownUncertainty</span></code></a> object which will not
propagate uncertainties in arithmetic operations.</p>
</div>
</div>
<div class="section" id="defining-wcs">
<h2>Defining WCS<a class="headerlink" href="#defining-wcs" title="Permalink to this headline">¶</a></h2>
<p>Specutils always maintains a WCS object whether it is passed explicitly by the
user, or is created dynamically by specutils itself. In the latter case, the
user need not be awrae that the WCS object is being used, and is can interact
with the <code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum1D</span></code> object as if it were only a simple
data container.</p>
<p>Currently, specutils understands two WCS formats: FITS WCS and GWCS. When a user
does not explicitly supply a WCS object, specutils will fallback on an internal
GWCS object it will create.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To create a custom adapter for a different WCS class (i.e. aside from
FITSWCS or GWCS), please see the documentation on WCS Adapter classes.</p>
</div>
<div class="section" id="providing-a-fits-style-wcs">
<h3>Providing a FITS-style WCS<a class="headerlink" href="#providing-a-fits-style-wcs" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">specutils.spectra</span> <span class="kn">import</span> <span class="n">Spectrum1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.wcs</span> <span class="kn">as</span> <span class="nn">fitswcs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="kn">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_wcs</span> <span class="o">=</span> <span class="n">fitswcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;CDELT1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;CRVAL1&#39;</span><span class="p">:</span> <span class="mf">6562.8</span><span class="p">,</span> <span class="s1">&#39;CUNIT1&#39;</span><span class="p">:</span> <span class="s1">&#39;Angstrom&#39;</span><span class="p">,</span> <span class="s1">&#39;CTYPE1&#39;</span><span class="p">:</span> <span class="s1">&#39;WAVE&#39;</span><span class="p">,</span> <span class="s1">&#39;RESTFRQ&#39;</span><span class="p">:</span> <span class="mi">1400000000</span><span class="p">,</span> <span class="s1">&#39;CRPIX1&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">Spectrum1D</span><span class="p">(</span><span class="n">flux</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Jy</span><span class="p">,</span> <span class="n">wcs</span><span class="o">=</span><span class="n">my_wcs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span><span class="o">.</span><span class="n">wavelength</span> 
<span class="go">&lt;Quantity [ 6538.8, 6539.8, 6540.8] Angstrom&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">pixel_to_world</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> 
<span class="go">array([6.5388e-07, 6.5398e-07, 6.5408e-07])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="multi-dimensional-data-sets">
<h2>Multi-dimensional Data Sets<a class="headerlink" href="#multi-dimensional-data-sets" title="Permalink to this headline">¶</a></h2>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Spectrum1D</span></code> also supports the multidimensional case where you
have, say, an <code class="docutils literal notranslate"><span class="pre">(n_spectra,</span> <span class="pre">n_pix)</span></code>
shaped data set where each <code class="docutils literal notranslate"><span class="pre">n_spectra</span></code> element provides a different flux
data array and so <code class="docutils literal notranslate"><span class="pre">flux</span></code> and <code class="docutils literal notranslate"><span class="pre">uncertainty</span></code> may be multidimensional as
long as the last dimension matches the shape of spectral_axis This is meant
to allow fast operations on collections of spectra that share the same
<code class="docutils literal notranslate"><span class="pre">spectral_axis</span></code>. While it may seem to conflict with the “1D” in the class
name, this name scheme is meant to communicate the presence of a single
common spectral axis.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The case where each flux data array is related to a <em>different</em> spectral
axis is encapsulated in the <code class="xref py py-class docutils literal notranslate"><span class="pre">SpectrumCollection</span></code>
object described in the <a class="reference internal" href="spectrum_collection.html"><span class="doc">related docs</span></a>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">specutils</span> <span class="kn">import</span> <span class="n">Spectrum1D</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">Spectrum1D</span><span class="p">(</span><span class="n">spectral_axis</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">5010</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="n">flux</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">Jy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec_slice</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec_slice</span><span class="o">.</span><span class="n">wavelength</span> 
<span class="go">&lt;Quantity [0., 1., 2., 3., 4., 5., 6., 7., 8., 9.] Angstrom&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec_slice</span><span class="o">.</span><span class="n">flux</span> 
<span class="go">&lt;Quantity [0.72722821, 0.32147784, 0.70256482, 0.04445197, 0.03390352,</span>
<span class="go">       0.50835299, 0.87581725, 0.50270413, 0.08556376, 0.53713355] Jy&gt;</span>
</pre></div>
</div>
<p>While the above example only shows two dimensions, this concept generalizes to
any number of dimensions for <code class="xref py py-obj docutils literal notranslate"><span class="pre">Spectrum1D</span></code>, as long as the spectral
axis is always the last.</p>
</div>
<div class="section" id="module-specutils.spectra.spectrum1d">
<span id="reference-api"></span><h2>Reference/API<a class="headerlink" href="#module-specutils.spectra.spectrum1d" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="api/specutils.spectra.spectrum1d.Spectrum1D.html#specutils.spectra.spectrum1d.Spectrum1D" title="specutils.spectra.spectrum1d.Spectrum1D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Spectrum1D</span></code></a>([flux,&nbsp;spectral_axis,&nbsp;wcs,&nbsp;…])</td>
<td>Spectrum container for 1D spectral data.</td>
</tr>
</tbody>
</table>
<object data="_images/inheritance-53ea94714548d315168c4fdd7fb9fd30f680395b.svg" type="image/svg+xml">
            <p class="warning">Inheritance diagram of specutils.spectra.spectrum1d.Spectrum1D</p></object>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Working with Spectrum1Ds</a><ul>
<li><a class="reference internal" href="#basic-spectrum-creation">Basic Spectrum Creation</a></li>
<li><a class="reference internal" href="#reading-from-a-file">Reading from a File</a></li>
<li><a class="reference internal" href="#including-uncertainties">Including Uncertainties</a></li>
<li><a class="reference internal" href="#defining-wcs">Defining WCS</a><ul>
<li><a class="reference internal" href="#providing-a-fits-style-wcs">Providing a FITS-style WCS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#multi-dimensional-data-sets">Multi-dimensional Data Sets</a></li>
<li><a class="reference internal" href="#module-specutils.spectra.spectrum1d">Reference/API</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="_sources/spectrum1d.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2018, Nicholas Earl.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.7.5. &nbsp;
    Last built 19 Sep 2018. <br/>
  </p>
</footer>
  </body>
</html>