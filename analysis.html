
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Analysis &#8212; specutils v0.4.dev1227</title>
    <link rel="stylesheet" href="_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="shortcut icon" href="_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="centroid" href="api/specutils.analysis.centroid.html" />
    <link rel="prev" title="SpectralRegion" href="api/specutils.spectra.spectral_region.SpectralRegion.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="_static/copybutton.js"></script>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="index.html"><span id="logotext1">spec</span><span id="logotext2">utils</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="genindex.html">Index</a></li>
    <li><a title="Module Index" href="py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="api/specutils.analysis.centroid.html" title="centroid">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="api/specutils.spectra.spectral_region.SpectralRegion.html" title="SpectralRegion">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="index.html">specutils v0.4.dev1227</a>
	 &#187;
      </li>
      
      <li>Analysis</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="analysis">
<h1>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h1>
<p>The specutils package comes with a set of tools for doing common analysis
tasks on astronomical spectra. Some examples of applying these tools are
described below. The basic spectrum shown here is used in the examples in the
sub-sections below - see <a class="reference internal" href="spectrum1d.html"><span class="doc">Working with Spectrum1Ds</span></a> for more on creating spectra:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy</span> <span class="k">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.nddata</span> <span class="k">import</span> <span class="n">StdDevUncertainty</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.modeling</span> <span class="k">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">specutils</span> <span class="k">import</span> <span class="n">Spectrum1D</span><span class="p">,</span> <span class="n">SpectralRegion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spectral_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spectral_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Gaussian1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">Jy</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="mf">0.8</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flux</span> <span class="o">=</span> <span class="n">spectral_model</span><span class="p">(</span><span class="n">spectral_axis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flux</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">spectral_axis</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Jy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uncertainty</span> <span class="o">=</span> <span class="n">StdDevUncertainty</span><span class="p">(</span><span class="mf">0.2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">flux</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">Jy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noisy_gaussian</span> <span class="o">=</span> <span class="n">Spectrum1D</span><span class="p">(</span><span class="n">spectral_axis</span><span class="o">=</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">,</span> <span class="n">uncertainty</span><span class="o">=</span><span class="n">uncertainty</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noisy_gaussian</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">noisy_gaussian</span><span class="o">.</span><span class="n">flux</span><span class="p">)</span> 
</pre></div>
</div>
<p>(<a class="reference external" href=".//analysis-1.py">Source code</a>, <a class="reference external" href=".//analysis-1.png">png</a>, <a class="reference external" href=".//analysis-1.hires.png">hires.png</a>, <a class="reference external" href=".//analysis-1.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/analysis-1.png" src="_images/analysis-1.png" />
</div>
<div class="section" id="snr">
<h2>SNR<a class="headerlink" href="#snr" title="Permalink to this headline">¶</a></h2>
<p>The signal-to-noise ratio of a spectrum is often a valuable quantity for
evaluating the quality of a spectrum.  The <a class="reference internal" href="api/specutils.analysis.snr.html#specutils.analysis.snr" title="specutils.analysis.snr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">specutils.analysis.snr</span></code></a> function
performs this task, either on the spectrum as a whole, or sub-regions of a
spectrum:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">specutils.analysis</span> <span class="kn">import</span> <span class="n">snr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snr</span><span class="p">(</span><span class="n">noisy_gaussian</span><span class="p">)</span>  
<span class="go">&lt;Quantity 2.95214319&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snr</span><span class="p">(</span><span class="n">noisy_gaussian</span><span class="p">,</span> <span class="n">SpectralRegion</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">))</span>  
<span class="go">&lt;Quantity 11.84806008&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="line-flux-estimates">
<h2>Line Flux Estimates<a class="headerlink" href="#line-flux-estimates" title="Permalink to this headline">¶</a></h2>
<p>While line-fitting (see <a class="reference internal" href="fitting.html"><span class="doc">Line/Spectrum Fitting</span></a>) is a more thorough way to measure
spectral line fluxes, direct measures of line flux are very useful for either
quick-look settings or for spectra not amedable to fitting.  The
<a class="reference internal" href="api/specutils.analysis.line_flux.html#specutils.analysis.line_flux" title="specutils.analysis.line_flux"><code class="xref py py-obj docutils literal notranslate"><span class="pre">specutils.analysis.line_flux</span></code></a> function addresses that use case. The closely
related <a class="reference internal" href="api/specutils.analysis.equivalent_width.html#specutils.analysis.equivalent_width" title="specutils.analysis.equivalent_width"><code class="xref py py-obj docutils literal notranslate"><span class="pre">specutils.analysis.equivalent_width</span></code></a> computes the equivalent width
of a spectral feature, a flux measure that is normalized against the continuum
of a spectrum.  Both are demonstrated below:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="api/specutils.analysis.line_flux.html#specutils.analysis.line_flux" title="specutils.analysis.line_flux"><code class="xref py py-obj docutils literal notranslate"><span class="pre">specutils.analysis.line_flux</span></code></a> function assumes the spectrum has
already been continuum-subtracted, while
<a class="reference internal" href="api/specutils.analysis.equivalent_width.html#specutils.analysis.equivalent_width" title="specutils.analysis.equivalent_width"><code class="xref py py-obj docutils literal notranslate"><span class="pre">specutils.analysis.equivalent_width</span></code></a> assumes the continuum is at a fixed,
known level (defaulting to 1, meaning continuum-normalized).
<a class="reference internal" href="fitting.html#specutils-continuum-fitting"><span class="std std-ref">Continuum Fitting</span></a> describes how continuua can be generated
to prepare a spectrum for use with these functions.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">specutils.analysis</span> <span class="kn">import</span> <span class="n">line_flux</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line_flux</span><span class="p">(</span><span class="n">noisy_gaussian</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">erg</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="o">**-</span><span class="mi">1</span><span class="p">)</span>  
<span class="go">&lt;Quantity 5.92896407e-14 erg / (cm2 s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#line_flux(noisy_gaussian, SpectralRegion(3*u.GHz, 7*u.GHz))  </span>
<span class="go">&lt;Quantity 6e-14 erg / (cm2 s)&gt;</span>
</pre></div>
</div>
<p>For the equivalen width, note the need to add a continuum level:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">specutils.analysis</span> <span class="kn">import</span> <span class="n">equivalent_width</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noisy_gaussian_with_continuum</span> <span class="o">=</span> <span class="n">noisy_gaussian</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">Jy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">equivalent_width</span><span class="p">(</span><span class="n">noisy_gaussian</span><span class="p">)</span>  
<span class="go">&lt;Quantity 4.07103593 GHz&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">equivalent_width</span><span class="p">(</span><span class="n">noisy_gaussian</span><span class="p">,</span> <span class="n">SpectralRegion</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span> <span class="mi">7</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">))</span>  
<span class="go">&lt;Quantity -5 GHz&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="centroid">
<h2>Centroid<a class="headerlink" href="#centroid" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="api/specutils.analysis.centroid.html#specutils.analysis.centroid" title="specutils.analysis.centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">specutils.analysis.centroid</span></code></a> function provides a first-moment analysis to
estimate the center of a spectral feature:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">specutils.analysis</span> <span class="kn">import</span> <span class="n">centroid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centroid</span><span class="p">(</span><span class="n">noisy_gaussian</span><span class="p">,</span> <span class="n">SpectralRegion</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span> <span class="mi">7</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">))</span>  
<span class="go">&lt;Quantity 4.99604264 GHz&gt;</span>
</pre></div>
</div>
<p>While this example is “pre-subtracted”, this function only performs well if the
contiuum has already been subtracted, as for the other functions above and
below.</p>
</div>
<div class="section" id="line-widths">
<h2>Line Widths<a class="headerlink" href="#line-widths" title="Permalink to this headline">¶</a></h2>
<p>There are several width statistics that are provided by the
<a class="reference internal" href="#module-specutils.analysis" title="specutils.analysis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">specutils.analysis</span></code></a> submodule.</p>
<p>The <a class="reference internal" href="api/specutils.analysis.gaussian_sigma_width.html#specutils.analysis.gaussian_sigma_width" title="specutils.analysis.gaussian_sigma_width"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gaussian_sigma_width</span></code></a> function estimates the width of the spectrum by
computing a second-moment-based approximation of the standard deviation.</p>
<p>The <a class="reference internal" href="api/specutils.analysis.gaussian_fwhm.html#specutils.analysis.gaussian_fwhm" title="specutils.analysis.gaussian_fwhm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gaussian_fwhm</span></code></a> function estimates the width of the spectrum at half max,
again by computing an approximation of the standard deviation.</p>
<p>Both of these functions assume that spectrum is approximately gaussian.</p>
<p>The function <a class="reference internal" href="api/specutils.analysis.fwhm.html#specutils.analysis.fwhm" title="specutils.analysis.fwhm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fwhm</span></code></a> provides an estimate of the full width of the spectrum at
half max that does not assume the spectrum is gaussian. It locates the maximum,
and then locates the value closest to half of the maximum on either side, and
measures the distance between them.</p>
<p>Each of the width analysis functions are applied to this spectrum below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">specutils.analysis</span> <span class="kn">import</span> <span class="n">gaussian_sigma_width</span><span class="p">,</span> <span class="n">gaussian_fwhm</span><span class="p">,</span> <span class="n">fwhm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussian_sigma_width</span><span class="p">(</span><span class="n">noisy_gaussian</span><span class="p">)</span> 
<span class="go">&lt;Quantity 0.93853592 GHz&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussian_fwhm</span><span class="p">(</span><span class="n">noisy_gaussian</span><span class="p">)</span> 
<span class="go">&lt;Quantity 2.21008321 GHz&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fwhm</span><span class="p">(</span><span class="n">noisy_gaussian</span><span class="p">)</span> 
<span class="go">&lt;Quantity 1.65829146 GHz&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="module-specutils.analysis">
<span id="reference-api"></span><h2>Reference/API<a class="headerlink" href="#module-specutils.analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="api/specutils.analysis.centroid.html#specutils.analysis.centroid" title="specutils.analysis.centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">centroid</span></code></a>(spectrum,&nbsp;region)</td>
<td>Calculate the centroid of a region, or regions, of the spectrum.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/specutils.analysis.equivalent_width.html#specutils.analysis.equivalent_width" title="specutils.analysis.equivalent_width"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equivalent_width</span></code></a>(spectrum[,&nbsp;continuum,&nbsp;regions])</td>
<td>Computes the equivalent width of a region of the spectrum.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="api/specutils.analysis.fwhm.html#specutils.analysis.fwhm" title="specutils.analysis.fwhm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fwhm</span></code></a>(spectrum[,&nbsp;region])</td>
<td>Compute the true full width half max of the spectrum.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/specutils.analysis.gaussian_fwhm.html#specutils.analysis.gaussian_fwhm" title="specutils.analysis.gaussian_fwhm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gaussian_fwhm</span></code></a>(spectrum[,&nbsp;region])</td>
<td>Estimate the width of the spectrum using a second-moment analysis.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="api/specutils.analysis.gaussian_sigma_width.html#specutils.analysis.gaussian_sigma_width" title="specutils.analysis.gaussian_sigma_width"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gaussian_sigma_width</span></code></a>(spectrum[,&nbsp;region])</td>
<td>Estimate the width of the spectrum using a second-moment analysis.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/specutils.analysis.line_flux.html#specutils.analysis.line_flux" title="specutils.analysis.line_flux"><code class="xref py py-obj docutils literal notranslate"><span class="pre">line_flux</span></code></a>(spectrum[,&nbsp;regions])</td>
<td>Computes the integrated flux in a spectrum or region of a spectrum.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="api/specutils.analysis.snr.html#specutils.analysis.snr" title="specutils.analysis.snr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">snr</span></code></a>(spectrum[,&nbsp;region])</td>
<td>Calculate the mean S/N of the spectrum based on the flux and uncertainty in the spectrum.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Analysis</a><ul>
<li><a class="reference internal" href="#snr">SNR</a></li>
<li><a class="reference internal" href="#line-flux-estimates">Line Flux Estimates</a></li>
<li><a class="reference internal" href="#centroid">Centroid</a></li>
<li><a class="reference internal" href="#line-widths">Line Widths</a></li>
<li><a class="reference internal" href="#module-specutils.analysis">Reference/API</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="_sources/analysis.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2018, Nicholas Earl.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.7.5. &nbsp;
    Last built 19 Sep 2018. <br/>
  </p>
</footer>
  </body>
</html>